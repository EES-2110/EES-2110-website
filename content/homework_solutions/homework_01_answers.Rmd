---
title: Chapter 2--3 Homework Solutions
hw_number: 1
pubdate: '2023-02-01'
date: '2023-01-25'
pdf_url: /files/homework_solutions/hw_01/homework_01_answers.pdf
slug: homework_01_answers
output:
  blogdown::html_page:
    md_extensions: +tex_math_single_backslash+compact_definition_lists
    toc: yes
  pdf_document:
    toc: yes
    toc_depth: 3.0
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(tidyverse)
library(lubridate)

data_dir = "_data"
script_dir = "_scripts"

# Create a data directory if one does not exist.
if (!dir.exists(data_dir)) dir.create(data_dir)

source(file.path(script_dir, 'utils.R'), chdir = T)
source(file.path(script_dir, 'format_md.R'), chdir = T)
source(file.path(script_dir, 'modtran.R'), chdir = T)
source(file.path(script_dir, "layer_diagram.R"), chdir = TRUE)

epsilon = 1
alpha = 0.30
sigma = 5.67E-8
I_solar = 1350
```

# Chapter 2: Exercises on Units, Energy, and Power

## Exercise 1

> A joule is an amount of energy, and a watt is a rate of using energy, 
> defined as $1~\text{W} = 1~\text{J}/\text{s}$. 
> How many joules of energy are required to run a 100 W light bulb for one day? 
> Burning coal yields about $30 \times 10^{6}~\text{J}$ of energy per kg of coal 
> burned. 
> Assuming that the coal power plant is 30% efficient, how much coal has to be 
> burned to light that light bulb for one day?

```{r ex_1, include=FALSE}
bulb_power = 100
bulb_seconds = 24 * 3600
bulb_energy = bulb_power * bulb_seconds
joules_per_kg_coal = 30E6
coal_efficiency = 0.3
bulb_coal = bulb_energy / (coal_efficiency * joules_per_kg_coal)
```


A 100 W light bulb burns 100 Joules per second. There are 3600 seconds in an 
hour and 24 hours in a day, so the light bulb will consume 
$$
\begin{aligned}
`r bulb_power`~\text{Watt} \times 1~\text{day} &=
100~\frac{\text{Joule}}{\text{second}} \times 1~\text{day} \\
&= `r bulb_power`~\frac{\text{Joule}}{\text{second}} \times 1~\cancel{\text{day}}
   \times \frac{24~\text{hours}}{\cancel{\text{day}}} \\
&= `r bulb_power`~\frac{\text{Joule}}{\text{second}} \times 24~\cancel{\text{hour}}
   \times \frac{3600~\text{seconds}}{\cancel{\text{hour}}} \\
&= `r bulb_power`~\frac{\text{Joule}}{\cancel{\text{second}}} \times 
  `r format_md(24 * 3600, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \cancel{\text{seconds}} \\
&= `r format_md(bulb_energy, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \text{Joules}
\end{aligned}
$$

Now, figure out how much coal you have to burn to produce the energy.
$$
\begin{aligned}
\text{coal burned} &= \frac{\text{Energy to power bulb}}{\text{Power plant efficiency} \times \text{Joules}/\text{kg coal}} \\
&= \frac{`r format_md(bulb_energy, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \text{Joules}}{`r format_md(coal_efficiency, digits = 1)` \times 
  `r format_md(joules_per_kg_coal, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
  \text{Joules}/\text{kg coal}} \\
&= \frac{`r format_md(bulb_energy, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \cancel{\text{Joules}}}{
  `r format_md(coal_efficiency * joules_per_kg_coal, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
  \cancel{\text{Joules}}/\text{kg coal}} \\
&= `r format_md(bulb_coal, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \text{kg coal}
\end{aligned}
$$


## Exercise 2

> This exercise asks you to calculate how many Joules of energy you
> can get for a dollar from different sources of energy.

### Part 2(a)

> (a) A gallon of gasoline carries with it about $1.3 \times 10^{8}$ J of energy. 
> Given a price of $3 per gallon, how many Joules can you get for a dollar?
  
  _Put your own text and R code here to answer Exercise 1(a). Do the calculation
using R and also explain what you are doing with your text, following the 
model of the worked example above._

```{r ex_2_a}
joules_per_gal_gasoline = 1.3E8
dollars_per_gal_gasoline = 3
joules_per_dollar_gasoline = joules_per_gal_gasoline / dollars_per_gal_gasoline
```

**Answer:** 
`r dollars_per_gal_gasoline` dollars buys you a gallon of gasoline, 
and a gallon of gasoline gives you 
`r format_md(joules_per_dollar_gasoline, digits = 2, format = "scientific")` Joules,
so you get 
$$\frac{1~\text{gallon}}{`r dollars_per_gal_gasoline`~\text{dollars}} \times 
  `r format_md(joules_per_gal_gasoline, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
  \frac{\text{Joules}}{\text{gallon}} = 
  `r format_md(joules_per_dollar_gasoline, format = "scientific", 
             digits = 2, output_format = "bare-latex")`~
  \frac{\text{Joules}}{\text{dollar}}$$
from gasoline. 

### Part 2(b)

> (b) Electricity goes for about $0.05 per kilowatt hour. A kilowatt hour is 
> just a weird way to write Joules because a watt is a Joule per second, and a 
> kilowatt hour is the number of Joules one would get from running 1000 W for 
> one hour (3,600 seconds). 
> How many Joules of electricity can you get for a dollar?
  
  
A kilowatt hour is the energy from using 1000 Watts for 1 hour, or 3,600 
seconds. A Watt is 1 Joule per second, so 
1 kWh = 1000 Watts &times; 3600 seconds.

```{r ex_2_b}
joules_per_kwh = 1000 * 3600
dollars_per_kwh = 0.05
joules_per_dollar_elec = joules_per_kwh / dollars_per_kwh
```

**Answer:**
\$`r dollars_per_kwh` buys you a kilowatt hour of electricity, 
and a kilowatt hour of electricity has 

$$
\begin{aligned}
1~\text{kilowatt}~\text{hour} &=
1~\cancel{\text{kilowatt}}~\text{hour} \times 
1,000~\frac{\text{Watts}}{\cancel{\text{kilowatt}}} \\
&= 1,000~\text{Watt}~\text{hours} \\
&= 1,000~\text{Watt}~\cancel{\text{hours}} \times \frac{3,600~\text{seconds}}{\cancel{\text{hour}}} \\
&= `r format_md(joules_per_kwh, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
   \text{Watt}~\text{seconds} \\
&= `r format_md(joules_per_kwh, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
   \cancel{\text{Watt}}~\text{seconds} \times 1~\frac{\text{Joule}/\text{second}}{\cancel{\text{Watt}}} \\
&= `r format_md(joules_per_kwh, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
   \cancel{\text{seconds}} \times 1~\frac{\text{Joule}}{\cancel{\text{second}}} \\
&= `r format_md(joules_per_kwh, digits = 2, comma = TRUE, format = "auto", output_format = "bare-latex")`~
   \text{Joules}\\
\end{aligned}
$$
so you get 

$$\frac{1~\text{kWh}}{`r dollars_per_kwh`~\text{dollars}} \times 
  `r format_md(joules_per_kwh, digits = 2, format = "auto", output_format = "bare-latex", comma = TRUE)`~
  \frac{\text{Joules}}{\text{kWh}} = 
  `r format_md(joules_per_dollar_elec, format = "scientific", 
             digits = 2, output_format = "bare-latex")`~
  \frac{\text{Joules}}{\text{dollar}}$$
from electricity. Written differently, that's 
`r format_md(joules_per_dollar_elec, digits = 1, comma = TRUE)` 
Joules per dollar. 

### Part 2(c)

> (c) A standard cubic foot of natural gas carries with it about 
> 1.1 &times; 10^6^ Joules of energy. 
> You can get about 5 &times; 10^5^ British Thermal Units (BTUs) of gas
> for a dollar, and there are about 1,030 BTUs in a standard cubic foot. 
> How many Joules of energy in the form of natural gas can you get for a dollar?
  
```{r ex_2_c}
joules_per_scf_gas = 1.1E6
btu_per_dollar = 5E5
btu_per_scf = 1030
scf_per_dollar = btu_per_dollar / btu_per_scf
joules_per_dollar_nat_gas = joules_per_scf_gas * scf_per_dollar
```

**Answer:** 

You can get 
`r format_md(btu_per_dollar, digits = 2, format = "auto", comma = TRUE)` 
BTU per dollar from natural gas, and there are 
`r format_md(btu_per_scf, digits = 2, format = "auto", comma = TRUE)` 
BTU per scf (standard cubic foot), so you can get
$$
`r format_md(btu_per_dollar, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\cancel{\text{BTU}} \times \frac{1~\text{scf}}{
`r format_md(btu_per_scf, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\cancel{\text{BTU}}} =
`r format_md(scf_per_dollar, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\text{scf}
$$
for a dollar.

One scf of natural gas has 
`r format_md(joules_per_scf_gas, digits = 2, format = "auto", comma = TRUE)`
Joules of energy, so you can get
$$
`r format_md(scf_per_dollar, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\cancel{\text{scf}}}{\text{dollar}}
\times
`r format_md(joules_per_scf_gas, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\cancel{\text{scf}}} = 
`r format_md(joules_per_dollar_nat_gas, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\text{dollar}}
$$

### Part 2(d)

> (d) A ton of coal holds about 3.2 &times; 10^10^ J of energy and costs 
> about $40.
> How many Joules of energy in the form of coal can you get for a dollar?
  
  
```{r ex_2_d}
joules_per_ton_coal = 3.2E10
dollars_per_ton_coal = 40
joules_per_dollar_coal = joules_per_ton_coal / dollars_per_ton_coal
```

**Answer:** 
One ton of coal has 
`r format_md(joules_per_ton_coal, digits = 2, format = "auto", comma = TRUE)`
Joules of energy, so you can get
$$
\frac{1~\cancel{\text{ton coal}}}{`r format_md(dollars_per_ton_coal, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~\text{dollar}}
\times
`r format_md(joules_per_ton_coal, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\cancel{\text{ton coal}}} = 
`r format_md(joules_per_dollar_coal, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\text{dollar}}
$$

### Part 2(e)

> (e) Corn oil costs about $0.10 per fluid ounce wholesale. A fluid ounce 
> carries about 240 dietary Calories (which a scientist would call 
                                      > kilocalories). 
> A dietary Calorie is about 4200 J. 
> How many Joules of energy in the form of corn oil can you get for a dollar?
  
```{r ex_2_e}
calories_per_oz_oil = 240
joules_per_calorie = 4200
dollars_per_oz_oil = 0.10
joules_per_oz_oil = calories_per_oz_oil * joules_per_calorie
joules_per_dollar_oil = joules_per_oz_oil / dollars_per_oz_oil
```

**Answer:** 
One ounce of oil has 
`r format_md(calories_per_oz_oil, digits = 2, format = "auto", comma = TRUE)` 
Calories, and there are 
`r format_md(joules_per_calorie, digits = 2, format = "auto", comma = TRUE)` 
Joules in a Calorie, so oil has 
$$
`r format_md(calories_per_oz_oil, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\cancel{\text{Calories}}}{\text{ounce}}
\times
`r format_md(joules_per_calorie, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\cancel{\text{Calorie}}}
=
`r format_md(joules_per_oz_oil, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\text{ounce}}
$$

One ounce of corn oil costs
\$`r format_md(dollars_per_oz_oil, digits = 2, format = "auto", comma = TRUE)`,
so you get 
$$
\frac{1~\cancel{\text{ounce}}}
{`r format_md(dollars_per_oz_oil, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\text{dollars}} \times 
`r format_md(joules_per_oz_oil, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\cancel{\text{ounce}}} = 
`r format_md(joules_per_dollar_oil, digits = 2, format = "auto", comma = TRUE, output_format="bare-latex")`~
\frac{\text{Joules}}{\text{dollar}}
$$

### Part 2(f)

> (f) Now we compare the different energy sources.
> Rank these five energy sources from cheap to expensive. 
> What is the range of prices per Joule?
  
  
```{r ex_2_f}
dollars_per_joule_coal = 1 / joules_per_dollar_coal
dollars_per_joule_nat_gas = 1 / joules_per_dollar_nat_gas
dollars_per_joule_gasoline = 1 / joules_per_dollar_gasoline
dollars_per_joule_oil = 1 / joules_per_dollar_oil
dollars_per_joule_elec = 1 / joules_per_dollar_elec
```

**Answer:** 
  
* Coal = 
  $`r format_md(dollars_per_joule_coal, digits = 2, format = "scientific")` 
per joule
* Natural gas = 
  $`r format_md(dollars_per_joule_nat_gas, digits = 2, format = "scientific")` 
per joule
* Electricity = 
  $`r format_md(dollars_per_joule_elec, digits = 2, format = "scientific")` 
per joule
* Gasoline = 
  $`r format_md(dollars_per_joule_gasoline, digits = 2, format = "scientific")` 
per joule
* Corn oil = 
  $`r format_md(dollars_per_joule_oil, digits = 2, format = "scientific")` 
per joule


## Exercise 4

> In this exercise, we compare the energy it took to produce the concrete in the
> Hoover Dam (outside Las Vegas) to the energy the dam produces from 
> hydroelectric generation. 

### Part 4(a)

> The Hoover Dam produces 2 &times; 10^9^ W of electricity. 
> It is composed of 7 &times; 10^9^ kg of concrete.
> It requires 1 MJ of energy (1 megajoule, 1,000,000 Joules) to produce 
> each kilogram of concrete. 
> How much energy did it take to produce the concrete for the dam? 
  
```{r ex_3_a}
kg_concrete = 7E9
joules_per_kg_concrete = 1E6
hoover_concrete_joules = kg_concrete * joules_per_kg_concrete
```

**Answer:** It took 
`r format_md(hoover_concrete_joules, digits = 1, format = "scientific")` Joules
to produce the concrete for the Hoover dam.

### Part 4(b)

> How long is the payback time for the dam to generate as much energy in 
> electricity as it took to produce the concrete?
  
**Answer:** 
The electric power the dam generates is measured in Watts, which are Joules per
second. If we divide the energy to produce the concrete by the power the dam
produces, the result will be the number of seconds for the dam's electric 
generation to pay back the energy it took to produce the concrete.

```{r ex_4_b}
hoover_power_watts = 2E9
hoover_payback_seconds = hoover_concrete_joules / hoover_power_watts
seconds_per_day = 24 * 3600
hoover_payback_days = hoover_payback_seconds / seconds_per_day
```

$$
\begin{aligned}
\text{Time to pay back energy} &= 
  \frac{\text{Energy to make concrete}}{\text{Power from dam}} \\
&= \frac{
  `r format_md(hoover_concrete_joules, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
  \text{Joules}}{
  `r format_md(hoover_power_watts, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
  \text{Watts}} \\
&= \frac{
  `r format_md(hoover_concrete_joules, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
  \cancel{\text{Joules}}}{
  `r format_md(hoover_power_watts, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
  \cancel{\text{Joules}}/\text{second}} \\
&= `r format_md(hoover_payback_seconds, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
   \text{seconds} \\
&= `r format_md(hoover_payback_seconds, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
   \cancel{\text{seconds}} \times 
   \frac{1~\cancel{\text{hour}}}{3,600~\cancel{\text{seconds}}} \times
   \frac{1~\text{day}}{24~\cancel{\text{hours}}} \\
&= `r format_md(hoover_payback_days, digits = 2, format = "auto", comma = TRUE, output_format = "bare-latex")`~
   \text{days}
\end{aligned}
$$

`r format_md(hoover_payback_seconds, digits = 2, comma = TRUE)` seconds,
or `r format_md(hoover_payback_days, digits = 2, comma = TRUE)` days, for the 
electricity generated by the Hoover dam to repay the energy it took to produce
the concrete in the dam.

## Exercise 5

> It takes approximately 2.0 &times; 10^9^ J of energy 
> to manufacture 1 m^2^ of crystalline-silicon photovoltaic cell.
> An average of 250 W/m^2^ falls on the Earth. 
> Assume that the solar cell is 18% efficient (that is, it converts 18% of
> the energy from sunlight into electricity). 
> Calculate how long it would take for the solar cell to repay the 
> energy it took to manufacture it.

```{r ex_5}
joule_per_sq_m_pv = 2E9
i_sun = 250
efficiency = 0.18
pv_power_watts = i_sun * efficiency
pv_payback_sec = joule_per_sq_m_pv / pv_power_watts
pv_payback_days = pv_payback_sec / seconds_per_day
days_per_year = 365
pv_payback_years = pv_payback_days / days_per_year
```

**Answer:** It takes 
`r format_md(pv_payback_sec, digits = 1, format = "scientific")` seconds,
or `r format_md(pv_payback_days, digits = 1)` days, or 
`r format_md(pv_payback_years, digits = 2)` years.

## Exercise 7

### Part 7(a)

> Infrared light has a wavelength of about 10 microns. 
> What is its wavenumber in cm^-1^?

From page 11 in the textbook,

$$
\begin{aligned}
n \left[ \frac{\text{cycles}}{\text{cm}} \right] &=
  \frac{1}{
  \lambda \left[ \frac{\text{cm}}{\text{cycle}} \right]
  }
1~\text{cm} &= 10,000 \mu\text{m} \\
n &= \frac{1}{10~\mu\text{m}} \\
&= \frac{1}{10~\cancel{\mu\text{m}} \times \frac{1~\text{cm}}{10,000 \cancel{\mu\text{m}}}} \\
&= \frac{1}{\frac{1}{1000}~\text{cm}} \\
&= 1000~\text{cm}^{-1}
\end{aligned}
$$

### Part 7(b)

> Visible light has a wavelength of about 0.5 microns. 
> Whas is its frequency in Hz (cycles per second)?

From page 10 of the textbook,

$$
\begin{aligned}
\lambda \left[ \frac{\text{cm}}{\text{cycle}} \right] &=
  \frac{c \left[ \frac{\text{cm}}{\text{second}} \right]}{
  \nu \left[ \frac{\text{cycles}}{\text{second}} \right]}
\end{aligned}
$$

We can rearrange this equation to give $\nu$ as a function of $\lambda$:

$$
\begin{aligned}
\nu \left[ \frac{\text{cycles}}{\text{second}} \right] &=
  \frac{c \left[ \frac{\text{cm}}{\text{second}} \right]}{
  \lambda \left[ \frac{\text{cm}}{\text{cycle}} \right]
  } \\
c &= 3\times10^{10}~\text{cm}/\text{second} \\
\nu &= \frac{3\times10^{10}~\text{cm}/\text{second}}{
0.5~\cancel{\mu\text{m}} \times \frac{1~\text{cm}}{10,000~\cancel{\mu\text{m}}}} \\
&= \frac{3\times10^{10}~\cancel{\text{cm}}/\text{second}}{
5\times 10^{-5}~\cancel{\text{cm}}} \\
&= `r format_md(3E10 / 0.5E-4, digits=2, format="auto", comma=TRUE, output_format="bare-latex")`~
\left[ \frac{\text{cycles}}{\text{second}}\right]
\end{aligned}
$$

### Part 7(c)

> FM radio operates at a frequency of about 100 MHz. 
> What is its wavelength?

Again, we use the equation from page 10, noting that 1 MHz is one million 
cycles per second:
$$
\begin{aligned}
\lambda \left[ \frac{\text{cm}}{\text{cycle}} \right] &=
  \frac{c \left[ \frac{\text{cm}}{\text{second}} \right]}{
  \nu \left[ \frac{\text{cycles}}{\text{second}} \right]} \\
&= \frac{3\times10^{10} \text{cm}/\cancel{\text{second}}}{100 \times 10^6~\left[\frac{\text{cycles}}{\cancel{\text{second}}} \right]} \\
&= `r format_md(3E10 / 100E6, digits = 2, comma=TRUE, format="auto", output_format="bare-latex")`~\text{cm}
\end{aligned}
$$

# Chapter 3: Layer Models

For these exercises, use the following numbers:

* I~solar~ = 1350 W/m^2^
* $\sigma = 5.67 \times 10^{-8}$
* $\alpha = 0.30$
* $\varepsilon = 1.0$

```{r set_constants, include=TRUE}
I_solar = 1350
sigma = 5.67E-8
alpha = 0.30
epsilon = 1.0
```

## Exercise 2

> **A Two-Layer Model.** Insert another atmospheric layer into the model, just 
> like the first one. The layer is transparent to visible light but a blackbody 
> for infrared.

```{r two_layer_figure, fig.cap = "An energy diagram for a planet with two panes of glass for an atmosphere. The intensity of absorbed visible light is $(1 - \\alpha) I_{solar} / 4$."}
make_layer_diagram(2)
```

> a) Write the energy budgets for both atmospheric layers, for the ground, and 
> for the Earth as a whole, like we did for the One-Layer Model.

**Answer:** 

At each layer, calculate the heat in (in the diagram, this is the sum of
all the intensities with arrows that end at the atmospheric layer) and the
heat out (the sum of all the intensities that start at the atmospheric
layer and have arrows pointing away from it).

* Top of the atmosphere:
  $I_{2,\text{up}} = I_{\text{visible}} = (1 - \alpha) I_{\text{solar}} / 4$
* Layer 2:
  $I_{1,\text{up}} = I_{2,\text{up}} + I_{2,\text{down}}$
* Layer 1:
  $I_{\text{ground,up}} + I_{2,\text{down}} = I_{1,\text{up}} + I_{1,\text{down}}$
* Ground:
  $I_{\text{ground,up}} = I_{\text{visible}} + I_{1,\text{down}}$

> b) Manipulate the budget for the Earth as a whole to obtain the temperature 
> T~2~ of the top atmospheric layer, labeled Atmospheric Layer 2 in the figure 
> above. Does this part of the exercise seem familiar in any way? Does the term 
> ring any bells?

Top of the atmosphere:

$$
\begin{aligned}
I_{2,\text{up}} &= I_{\text{visible}} = \frac{(1 - \alpha) I_{\text{solar}}}{4}\\
I_{2,\text{up}} &= \varepsilon \sigma T_2^4\\
T_2 &= \sqrt[4]{\frac{I_{2,\text{up}}}{\varepsilon \sigma}} \\
    &= \sqrt[4]{\frac{(1 - \alpha) I_{\text{solar}}}{4 \varepsilon \sigma}} \\
    &= T_{\text{bare rock}}
\end{aligned}
$$

This is the same as the bare-rock temperature.

```{r ex_3_2_b}
I_visible = (1 - alpha) * I_solar / 4
I_2_up = I_visible
T_2 = (I_2_up / (epsilon * sigma))^0.25
```

**Answer:** The temperature of layer 2 is `r format_md(T_2, digits = 3)` K,
which is the same as the bare-rock temperature. In layer models, the top layer 
of the atmosphere is _always_ the bare-rock temperature.

> c) Insert the value you found for T~2~ into the energy budget for layer 2, and 
> solve for the temperature of layer 1 in terms of layer 2. How much bigger is 
> T~1~ than T~2~?

From the energy budget for Layer 2, 
I~1,up~ = I~2,up~ + I~2,down~.
The temperature of the bottom of the layer is the same as the temperature for
the top of the layer, so I~2,down~ = I~2,up~

```{r ex_3_2_c}
I_1_up = 2 * I_2_up
T_1 = (I_1_up / (epsilon * sigma))^0.25
```

$$
\begin{aligned}
I_{\text{2,down}} &= I_{\text{2,up}} \\
I_{\text{1,up}} &= I_{\text{2,up}} + I_{\text{2,down}} \\
 &= 2 I_{\text{2,up}} \\
T_1 &= \sqrt[4]{\frac{I_{\text{1,up}}}{\epsilon \sigma}} \\
  &= \sqrt[4]{\frac{2 I_{\text{2,up}}}{\epsilon \sigma}} \\
  &= \sqrt[4]{2} T_2 \\
  &= \sqrt[4]{2}\; T_{\text{bare rock}} \\
\end{aligned}
$$

**Answer:** The temperature of layer 1 is `r format_md(T_1, digits = 3)` K.
This is the same as the ground temperature in a 1-layer model.

> d) Now insert the value you found for T~1~ into the budget for atmospheric 
> layer 1 to obtain the temperature of the ground, T~ground~. Is the greenhouse 
> effect stronger or weaker because of the second layer?

From the energy budget for layer 1, 

$$
\begin{aligned}
I_{\text{ground,up}} + I_{\text{2,down}} &= I_{\text{1,up}} + I_{\text{1,down}} \\
I_{\text{ground,up}} &= I_{\text{1,up}} + I_{\text{1,down}} - I_{\text{2,down}} \\
\text{we} &\text{ know that} \\
I_{\text{1,down}} &= I_{\text{1,up}} \\
&\text{and} \\
I_{\text{2,down}} &= I_{\text{2,up}} \\
&\text{so} \\
I_{\text{ground,up}} &= 2 I_{\text{1,up}} - I_{\text{2,up}} \\
\text{we} &\text{ also know that} \\
I_{\text{1,up}} &= 2 I_{\text{2,up}} \\
&\text{so} \\
I_{\text{ground,up}} &= 4 I_{\text{2,up}} - I_{\text{2,up}} \\
&= 3 I_{\text{2,up}}
\end{aligned}
$$

```{r ex_3_2_d}
I_ground_up = 2 * I_1_up - I_2_up
T_ground = (I_ground_up / (epsilon * sigma))^0.25
```

$$
\begin{aligned}
T_{\text{ground}} &= 
  \sqrt[4]{\frac{I_{\text{ground,up}}}{\varepsilon \sigma}} \\
&= \sqrt[4]{\frac{3 I_{\text{2,up}}}{\varepsilon \sigma}} \\
  &= \sqrt[4]{3}\; T_2 \\
  &= \sqrt[4]{3}\; T_{\text{bare rock}}
\end{aligned}
$$

**Answer:** T~ground~ = `r format_md(T_ground, digits = 3)` K = $\displaystyle\sqrt[4]{3 T_{\text{bare rock}}}$

In a 1-layer model, the ground temperature was $\sqrt[4]{2}$ times the bare-rock 
temperature, and in a 2-layer model, the ground temperature is $\sqrt[4]{3}$ times
the bare-rock temperature.

## Exercise 3.3

```{r nuclear_winter_diagram, fig.cap="An energy diagram for a planet with an opaque pane of glass for an atmosphere. The intensity of absorbed visible light is $(1 - \\alpha) I_{solar} / 4$."}
make_nuclear_winter_diagram()
```

> **Nuclear Winter.** Let us go back to the One-Layer Model but change it so 
> that the atmospheric layer absorbs visible light rather than allowing it to 
> pass through (See the figure above). This could happen if the upper atmosphere 
> were filled with dust. For simplicity, assume that the albedo of the Earth 
> remains the same, even though in the real world it might change with a dusty 
> atmosphere.>  What is the temperature of the ground in this case?

**Answer:** 
Here, the key difference is that the heat from the sun is absorbed by the 
atmosphere instead of passing through the atmosphere to the ground.

The equation for the atmosphere is the same as in the 1-layer model because
we use the energy balance at the boundary to space:

$$I_{\text{atm, up}} = I_{\text{visible}} = \frac{(1 - \alpha) I_{\text{solar}}}{4}$$

and the temperature of the atmosphere is the bare-rock temperature, just as 
the top layer of the atmosphere is for every layer model.

However, things are different at the ground. The energy balance at the 
dusty atmosphere is

$$
\begin{aligned}
I_{\text{visible}} + I_{\text{ground,up}} &= I_{\text{atm,up}} + I_{\text{atm,down}} \\
I_{\text{ground,up}} &= I_{\text{atm,up}} + I_{\text{atm,down}} - I_{\text{visible}} \\
& \text{But} \\
I_{\text{atm,up}} &= I_{\text{atm,down}} = I_{\text{visible}}. \\
& \text{So} \\
I_{\text{ground,up}} &= I_{\text{atm,up}}. \\
\text{This} & \text{ means that} \\
T_{\text{ground}} &= T_{\text{atmosphere}} = T_{\text{bare-rock}}
\end{aligned}
$$


```{r ex_3}
I_visible = (1 - alpha) * I_solar / 4
I_atm_up = I_visible
I_atm_down = I_visible
I_ground_up = I_atm_up + I_atm_down - I_visible
T_ground = (I_ground_up / (epsilon * sigma))^0.25
```

T_ground = `r format_md(T_ground, digits = 3)` K. This is the same as the 
bare-rock temperature.

The effect of the dust in the atmosphere is to cancel out the greenhouse effect
and cool off the surface to the bare-rock temperature. 
The greenhouse effect works because the atmosphere is transparent to shortwave
light and opaque to longwave light. If the atmosphere becomes opaque to 
shortwave light, then the greenhouse effect doesn't work.

